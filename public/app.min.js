(function () {
    'use strict';

    var app = angular.module('app', [
        // Predefined modules.
        'ui.bootstrap',
        'ui.router',
        'ngResource',
        'ngRoute',

        // App components.
        'app.home',
        'app.recipes',

        // Admin components.
        'app.admin',
        'app.profile',
        'app.signUp',

        // App shared.
        'app.providers',
        'app.services',
        'app.resources'
    ]);
})();
(function () {
    'use strict';

    angular.module('app.admin', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.home', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.profile', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.recipes', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.signUp', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.providers', []);

})();
(function () {
    'use strict';

    angular.module('app.resources', []);

})();
(function () {
    'use strict';

    angular.module('app.services', []);

})();
(function () {
    'use strict';

    var app = angular.module('app');

    app.config(Configuration);

    Configuration.$inject = ['$logProvider', '$stateProvider', '$urlRouterProvider', '$locationProvider'];

    function Configuration($logProvider, $stateProvider, $urlRouterProvider, $locationProvider) {
        // Logging.
        $logProvider.debugEnabled(true);

        // HTML5 mode.
        $locationProvider.html5Mode({
            enabled: true,
            requireBase: false
        });

        // Always default to home page.
        $urlRouterProvider.otherwise('/app/home');

        // Routes.
        var defaultCtrlAs = 'vm';
        var mainViewsObj = {
            nav: {
                templateUrl: '/partials/layout/navTmpl',
                controller: 'NavCtrl',
                controllerAs: defaultCtrlAs
            },
            '': {
                templateUrl: '/partials/layout/contentTmpl',
                controller: 'ContentCtrl',
                controllerAs: defaultCtrlAs
            },
            sidebar: {
                templateUrl: '/partials/layout/sidebarTmpl',
                controller: 'SidebarCtrl',
                controllerAs: defaultCtrlAs
            },
            footer: {
                templateUrl: '/partials/layout/footerTmpl',
                controller: 'FooterCtrl',
                controllerAs: defaultCtrlAs
            }
        };

        $stateProvider
            .state('app', {
                abstract: true,
                url: '/app',
                views: mainViewsObj
            });
    }

    // Add extra properties to each state.
    app.run(['$rootScope', function ($rootScope) {
        $rootScope.$on('$stateChangeSuccess', function (event, current) {
            $rootScope.title = current.title;
            $rootScope.bodyCss = current.bodyCss;
        });
    }]);

})();
(function () {
    'use strict';

    var appAdmin = angular.module('app.admin');

    //=========================================================================
    // Config.
    //=========================================================================
    appAdmin.config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        var routeRoleChecks = {
            admin: {
                auth: function (authService) {
                    return authService.authorizeCurrentUserForRoute('admin');
                }
            }
        };

        $stateProvider
            .state('app.userList', {
                url: '/user-list',
                templateUrl: '/partials/components/admin/userListView',
                controller: 'UserListCtrl',
                controllerAs: 'vm',
                resolve: routeRoleChecks.admin,
                title: 'User List',
                bodyCss: 'user-list'
            });
    }

    //=========================================================================
    // Run.
    //=========================================================================
    appAdmin.run(Run);

    Run.$inject = ['$rootScope', '$state'];

    function Run($rootScope, $state) {
        $rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {
            if (error.notAuthorized) {
                $state.go('app.home');
            }
        });
    }
})();
(function () {
    'use strict';

    angular.module('app.home').config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        $stateProvider
            .state('app.home', {
                url: '/home',
                templateUrl: '/partials/components/home/homeView',
                controller: 'HomeCtrl',
                controllerAs: 'vm',
                title: 'Home',
                bodyCss: 'home'
            });
    }

})();
(function () {
    'use strict';

    angular.module('app.profile').config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        var routeRoleChecks = {
            user: {
                auth: function (authService) {
                    return authService.authorizeAuthenticatedUserForRoute();
                }
            }
        };

        $stateProvider
            .state('app.profile', {
                url: '/profile',
                templateUrl: '/partials/components/profile/profileView',
                controller: 'ProfileCtrl',
                controllerAs: 'vm',
                resolve: routeRoleChecks.user,
                title: 'Profile',
                bodyCss: 'profile'
            });
    }

})();
(function () {
    'use strict';

    angular.module('app.recipes').config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        $stateProvider
            .state('app.recipes', {
                url: '/recipes',
                templateUrl: '/partials/components/recipes/recipesView',
                controller: 'RecipesCtrl',
                controllerAs: 'vm',
                title: 'Recipes',
                bodyCss: 'recipes'
            })
            .state('app.recipeDetails', {
                url: '/recipe/:id',
                templateUrl: '/partials/components/recipes/recipeDetailsView',
                controller: 'RecipeDetailsCtrl',
                controllerAs: 'vm',
                title: 'Recipe Details',
                bodyCss: 'recipe-details'
            });
    }

})();
(function () {
    'use strict';

    var appSignUp = angular.module('app.signUp');

    //=========================================================================
    // Config.
    //=========================================================================
    appSignUp.config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        $stateProvider
            .state('app.signUp', {
                url: '/sign-up',
                templateUrl: '/partials/components/signUp/signUpView',
                controller: 'SignUpCtrl',
                controllerAs: 'vm',
                title: 'Sign Up',
                bodyCss: 'sign-up'
            });
    }

})();
(function () {
    'use strict';

    angular.module('app.providers').config(Configuration);

    Configuration.$inject = [];

    function Configuration() {

    }

})();
(function () {
    'use strict';

    angular.module('app.resources').config(Configuration);

    Configuration.$inject = [];

    function Configuration() {

    }

})();
(function () {
    'use strict';

    angular.module('app.services').config(Configuration);

    Configuration.$inject = [];

    function Configuration() {

    }

})();
(function () {
    'use strict';

    angular.module('app').controller('ContentCtrl', ContentCtrl);

    ContentCtrl.$inject = ['logger'];

    function ContentCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(ContentCtrl, init, 'Initializing...');
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('FooterCtrl', FooterCtrl);

    FooterCtrl.$inject = ['logger'];

    function FooterCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(FooterCtrl, init, 'Initializing...');
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('NavCtrl', NavCtrl);

    NavCtrl.$inject = ['logger', '$http', '$state', 'notificationProvider', 'identityService', 'authService'];

    function NavCtrl(logger, $http, $state, notificationProvider, identityService, authService) {
        var vm = this;

        //=====================================================================
        // Expose functions.
        //=====================================================================
        vm.logIn = logIn;
        vm.logOut = logOut;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(NavCtrl, init, 'Initializing...');
            vm.identity = identityService;
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function logIn() {
            logger.debug(NavCtrl, logIn, 'Signing in...');

            authService.authenticateUser(vm.username, vm.password)
                .then(function (success) {
                    if (success) {
                        notificationProvider.success('You have successfully logged in.');
                    } else {
                        notificationProvider.error('Invalid user name or password!');
                    }
                });
        }

        function logOut() {
            logger.debug(NavCtrl, logOut, 'Signing in...');

            authService.logOutUser()
                .then(function () {
                    vm.username = '';
                    vm.password = '';
                    notificationProvider.info('You have been logged out.');
                    $state.go('app.home');
                });
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('SidebarCtrl', SidebarCtrl);

    SidebarCtrl.$inject = ['logger'];

    function SidebarCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(SidebarCtrl, init, 'Initializing...');
            vm.test = 'test string';
        }

    }
})();
(function () {
    'use strict';

    angular.module('app.admin').controller('UserListCtrl', UserListCtrl);

    UserListCtrl.$inject = ['$scope', 'logger', 'UserResource'];

    function UserListCtrl($scope, logger, UserResource) {
        var vm = this;

        init();

        function init() {
            logger.debug(UserListCtrl, init, 'Initializing...');
            vm.users = UserResource.query();
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.home').controller('HomeCtrl', HomeCtrl);

    HomeCtrl.$inject = ['$scope', 'logger'];

    function HomeCtrl($scope, logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(HomeCtrl, init, 'Initializing...');
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.profile').controller('ProfileCtrl', ProfileCtrl);

    ProfileCtrl.$inject = ['$scope', 'logger', 'validation', 'authService', 'identityService', 'notificationProvider'];

    function ProfileCtrl($scope, logger, validation, authService, identityService, notificationProvider) {
        var vm = this;

        //=====================================================================
        // Exposed functions.
        //=====================================================================
        vm.getClass = validation.getClass;
        vm.update = update;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(ProfileCtrl, init, 'Initializing...');

            // Update view.
            vm.email = identityService.currentUser.username;
            vm.firstName = identityService.currentUser.firstName;
            vm.lastName = identityService.currentUser.lastName;
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function update() {
            logger.debug(ProfileCtrl, update, 'Updating user profile...');
            vm.isLoading = true;

            var newUserData = {
                username: vm.email,
                firstName: vm.firstName,
                lastName: vm.lastName
            };

            if (vm.password && vm.password.length > 0) {
                newUserData.password = vm.password;
            }

            authService.updateCurrentUser(newUserData)
                .then(function () {
                    notificationProvider.success('Your user profile has been updated.');
                })
                .catch(function (reason) {
                    notificationProvider.error(reason);
                })
                .finally(function () {
                    vm.isLoading = false;
                });
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.recipes').controller('RecipeDetailsCtrl', RecipeDetailsCtrl);

    RecipeDetailsCtrl.$inject = ['$scope', 'logger', '$stateParams', 'RecipeResource'];

    function RecipeDetailsCtrl($scope, logger, $stateParams, RecipeResource) {
        var vm = this;

        //=====================================================================
        // Exposed functions.
        //=====================================================================
        vm.getIngredientDisplay = getIngredientDisplay;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(RecipeDetailsCtrl, init, 'Initializing...');

            RecipeResource.get({ _id: $stateParams.id }, function (data) {
                vm.recipe = data;
            });
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function getIngredientDisplay(ingredient) {
            var quantityStr = ingredient.quantity.trim();
            var nameStr = ingredient.name.trim();

            if (!isNaN(ingredient.quantity)) {
                quantityStr += ' x ';
                if (ingredient.quantity > 1) {
                    nameStr += 's';
                }
            } else {
                quantityStr += ' of '
            }

            return quantityStr + nameStr;
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.recipes').controller('RecipesCtrl', RecipesCtrl);

    RecipesCtrl.$inject = ['$scope', 'logger', 'RecipeResource'];

    function RecipesCtrl($scope, logger, RecipeResource) {
        var vm = this;

        //=====================================================================
        // Constants.
        //=====================================================================
        vm.pageNumber = 1;
        vm.pageSize = 10;
        vm.debounce = { debounce: 300 };

        //=====================================================================
        // Exposed functions.
        //=====================================================================
        vm.getFiltered = getFiltered;
        vm.update = update;
        vm.getMainIngredientsStr = getMainIngredientsStr;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(RecipesCtrl, init, 'Initializing...');
            RecipeResource.query(function (data) {
                vm.recipes = _.sortBy(data, 'name');
                vm.update();
            });
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function getFiltered() {
            var lowerCaseSearch = vm.search ? vm.search.toLowerCase() : null;

            var result = _.filter(vm.recipes, function (recipe) {
                var searchResult = !vm.search
                    || recipe.name.toLowerCase().indexOf(lowerCaseSearch) >= 0
                    || _.filter(recipe.ingredients, function (ingredient) {
                        return ingredient.name.toLowerCase().indexOf(lowerCaseSearch) >= 0;
                    }).length > 0;

                var maxTimeResult = !vm.maxTime || recipe.time <= vm.maxTime;

                return searchResult && maxTimeResult;
            });

            return result;
        }

        function update() {
            vm.filteredRecipes = getFiltered();

            // Calculate page.
            vm.startIndex = Math.max((vm.pageNumber - 1) * vm.pageSize, 0);
            vm.endIndex = Math.min(vm.pageNumber * vm.pageSize, vm.filteredRecipes.length);
            vm.pagedRecipes = vm.filteredRecipes.slice(vm.startIndex, vm.endIndex);
        }

        function getMainIngredientsStr(ingredients) {
            var mainIngredients = _.filter(ingredients, function (ingredient) {
                return ingredient.isMain;
            });

            var names = _.map(mainIngredients, function (ingredient) {
                if (!isNaN(ingredient.quantity)) {
                    return ingredient.name.trim() + 's';
                }

                return ingredient.name.trim();
            });

            var joinedStr = names.join(', ');
            if (joinedStr.length > 0) {
                joinedStr = joinedStr[0].toUpperCase() + joinedStr.slice(1);
                joinedStr += '.';
            }

            return joinedStr;
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.signUp').controller('SignUpCtrl', SignUpCtrl);

    SignUpCtrl.$inject = ['$scope', '$state', 'logger', 'notificationProvider', 'validation', 'authService'];

    function SignUpCtrl($scope, $state, logger, notificationProvider, validation, authService) {
        var vm = this;

        //=====================================================================
        // Exposed functions.
        //=====================================================================
        vm.getClass = validation.getClass;
        vm.signUp = signUp;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(SignUpCtrl, init, 'Initializing...');
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function signUp() {
            logger.debug(SignUpCtrl, signUp, 'Submitting form...');
            vm.isLoading = true;

            var newUserData = {
                username: vm.email,
                password: vm.password,
                firstName: vm.firstName,
                lastName: vm.lastName
            };

            authService.createUser(newUserData)
                .then(function () {
                    notificationProvider.success('User successfully created.');
                    $state.go('app.home');
                })
                .catch(function (errorResponse) {
                    notificationProvider.error(errorResponse);
                })
                .finally(function () {
                    vm.isLoading = false;
                });
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.providers').factory('logger', Logger);

    Logger.$inject = ['$log'];

    function Logger($log) {
        //=====================================================================
        // Exposed functions.
        //=====================================================================
        function debug(ctrl, func, msg) {
            $log.debug(buildMsg(ctrl, func, msg));
        }

        function error(ctrl, func, msg) {
            $log.error(buildMsg(ctrl, func, msg));
        }

        function info(ctrl, func, msg) {
            $log.info(buildMsg(ctrl, func, msg));
        }

        function log(ctrl, func, msg) {
            $log.log(buildMsg(ctrl, func, msg));
        }

        function warn(ctrl, func, msg) {
            $log.warn(buildMsg(ctrl, func, msg));
        }

        //=====================================================================
        // Helper functions.
        //=====================================================================
        function buildMsg(ctrl, func, msg) {
            return ctrl.name + ' -> ' + func.name + '(): ' + msg;
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            debug: debug,
            error: error,
            info: info,
            log: log,
            warn: warn
        };
    }

})();

(function () {
    'use strict';

    angular.module('app.providers').value('toastr', toastr);
    angular.module('app.providers').factory('notificationProvider', NotificationProvider);

    NotificationProvider.$inject = ['toastr', 'logger'];

    function NotificationProvider(toastr, logger) {
        //=====================================================================
        // Toastr options.
        //=====================================================================
        toastr.options = {
            closeButton: false,
            debug: false,
            newestOnTop: false,
            progressBar: false,
            positionClass: 'toast-top-center',
            preventDuplicates: false,
            onclick: null,
            showDuration: 500,
            hideDuration: 1000,
            timeOut: 2000,
            extendedTimeOut: 1000,
            showEasing: 'swing',
            hideEasing: 'linear',
            showMethod: 'fadeIn',
            hideMethod: 'fadeOut'
        };

        //=====================================================================
        // Public functions.
        //=====================================================================
        function success(msg) {
            toastr.success(msg);
            logger.debug(NotificationProvider, success, msg);
        }

        function info(msg) {
            toastr.info(msg);
            logger.debug(NotificationProvider, info, msg);
        }

        function warning(msg) {
            toastr.warning(msg);
            logger.debug(NotificationProvider, warning, msg);
        }

        function error(msg) {
            toastr.error(msg);
            logger.debug(NotificationProvider, error, msg);
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            success: success,
            info: info,
            warning: warning,
            error: error
        };
    }

})();
(function () {
    'use strict';

    angular.module('app.providers').factory('validation', Validation);

    Validation.$inject = [];

    function Validation() {
        //=====================================================================
        // Exposed functions.
        //=====================================================================
        function hasError(form, formElement) {
            return form.$submitted && formElement.$invalid;
        }

        function hasWarn(form, formElement) {
            return !form.$submitted && formElement.$dirty && formElement.$invalid;
        }

        function hasSuccess(formElement) {
            return formElement.$dirty && !formElement.$invalid;
        }

        function getClass(form, formElement) {
            return {
                'has-error': hasError(form, formElement),
                'has-warning': hasWarn(form, formElement),
                'has-success': hasSuccess(formElement)
            };
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            hasError: hasError,
            hasWarn: hasWarn,
            hasSuccess: hasSuccess,
            getClass: getClass
        };
    }

})();
(function () {
    'use strict';

    angular.module('app.resources').factory('RecipeResource', RecipeResource);

    RecipeResource.$inject = ['$resource'];

    function RecipeResource($resource) {
        //=====================================================================
        // Resource.
        //=====================================================================
        var RecipeRes = $resource('/api/recipes/:_id', { _id: '@id' }, {
            update: { method: 'PUT', isArray: false }
        });

        RecipeRes.prototype.temp = function () {

        };

        return RecipeRes;
    }

})();
(function () {
    'use strict';

    angular.module('app.resources').factory('UserResource', UserResource);

    UserResource.$inject = ['$resource'];

    function UserResource($resource) {
        //=====================================================================
        // Resource.
        //=====================================================================
        var UserRes = $resource('/api/users/:id', {_id: '@id'}, {
            update: { method: 'PUT', isArray: false }
        });

        UserRes.prototype.isAdmin = function () {
            return this.roles && this.roles.indexOf('admin') >= 0;
        };

        return UserRes;
    }

})();
(function () {
    'use strict';

    angular.module('app.services').factory('authService', AuthService);

    AuthService.$inject = ['$http', '$q', 'logger', 'identityService', 'UserResource'];

    function AuthService($http, $q, logger, identityService, UserResource) {
        //=====================================================================
        // Variables.
        //=====================================================================
        var notAuthorizedObj = { notAuthorized: true };

        //=====================================================================
        // Public functions.
        //=====================================================================
        function authenticateUser(username, password) {
            var deferred = $q.defer();

            $http.post('/login', {
                username: username,
                password: password
            }).then(function (response) {
                if (response.data.success) {
                    var user = new UserResource();
                    angular.extend(user, response.data.user);

                    // Save current user.
                    identityService.currentUser = user;

                    deferred.resolve(true);
                } else {
                    deferred.resolve(false);
                }
            });

            return deferred.promise;
        }

        function logOutUser() {
            var deferred = $q.defer();

            $http.post('/logout', { logOut: true })
                .then(function () {
                    identityService.currentUser = null;
                    deferred.resolve();
                });

            return deferred.promise;
        }

        function createUser(newUserData) {
            var deferred = $q.defer();
            var newUser = new UserResource(newUserData);

            newUser.$save()
                .then(function () {
                    identityService.currentUser = newUser;
                    deferred.resolve();
                })
                .catch(function (errorResponse) {
                    deferred.reject(errorResponse.data.reason);
                });

            return deferred.promise;
        }

        function updateCurrentUser(newUserData) {
            var deferred = $q.defer();

            var clone = angular.copy(identityService.currentUser);
            angular.extend(clone, newUserData);

            clone.$update()
                .then(function () {
                    identityService.currentUser = clone;
                    deferred.resolve();
                })
                .catch(function (errorResponse) {
                    deferred.reject(errorResponse.data.reason);
                });

            return deferred.promise;
        }

        function authorizeCurrentUserForRoute(role) {
            if (identityService.isAuthorized(role)) {
                return true;
            } else {
                return $q.reject(notAuthorizedObj);
            }
        }

        function authorizeAuthenticatedUserForRoute() {
            if (identityService.isAuthenticated()) {
                return true;
            } else {
                return $q.reject(notAuthorizedObj);
            }
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            authenticateUser: authenticateUser,
            logOutUser: logOutUser,
            createUser: createUser,
            updateCurrentUser: updateCurrentUser,
            authorizeCurrentUserForRoute: authorizeCurrentUserForRoute,
            authorizeAuthenticatedUserForRoute: authorizeAuthenticatedUserForRoute
        };
    }

})();
(function () {
    'use strict';

    angular.module('app.services').factory('identityService', IdentityService);

    IdentityService.$inject = ['$window', 'logger', 'UserResource'];

    function IdentityService($window, logger, UserResource) {
        //=====================================================================
        // Handle bootstrapped current user object.
        //=====================================================================
        var currentUser = null;

        if (!!$window.bootstrappedUserObject) {
            currentUser = new UserResource();
            angular.extend(currentUser, $window.bootstrappedUserObject);
        }

        //=====================================================================
        // Public functions.
        //=====================================================================
        function isAuthenticated() {
            return !!this.currentUser;
        }

        function isAuthorized(role) {
            return !!this.currentUser && this.currentUser.roles.indexOf(role) >= 0;
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            currentUser: currentUser,
            isAuthenticated: isAuthenticated,
            isAuthorized: isAuthorized
        };
    }

})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2FkbWluL2FwcC5hZG1pbi5tb2R1bGUuanMiLCJjb21wb25lbnRzL2hvbWUvYXBwLmhvbWUubW9kdWxlLmpzIiwiY29tcG9uZW50cy9wcm9maWxlL2FwcC5wcm9maWxlLm1vZHVsZS5qcyIsImNvbXBvbmVudHMvcmVjaXBlcy9hcHAucmVjaXBlcy5tb2R1bGUuanMiLCJjb21wb25lbnRzL3NpZ25VcC9hcHAuc2lnblVwLm1vZHVsZS5qcyIsInNoYXJlZC9wcm92aWRlcnMvYXBwLnByb3ZpZGVycy5tb2R1bGUuanMiLCJzaGFyZWQvcmVzb3VyY2VzL2FwcC5yZXNvdXJjZXMubW9kdWxlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2FwcC5zZXJ2aWNlcy5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiY29tcG9uZW50cy9hZG1pbi9hcHAuYWRtaW4uY29uZmlnLmpzIiwiY29tcG9uZW50cy9ob21lL2FwcC5ob21lLmNvbmZpZy5qcyIsImNvbXBvbmVudHMvcHJvZmlsZS9hcHAucHJvZmlsZS5jb25maWcuanMiLCJjb21wb25lbnRzL3JlY2lwZXMvYXBwLnJlY2lwZXMuY29uZmlnLmpzIiwiY29tcG9uZW50cy9zaWduVXAvYXBwLnNpZ25VcC5jb25maWcuanMiLCJzaGFyZWQvcHJvdmlkZXJzL2FwcC5wcm92aWRlcnMuY29uZmlnLmpzIiwic2hhcmVkL3Jlc291cmNlcy9hcHAucmVzb3VyY2VzLmNvbmZpZy5qcyIsInNoYXJlZC9zZXJ2aWNlcy9hcHAuc2VydmljZXMuY29uZmlnLmpzIiwibGF5b3V0L2NvbnRlbnRDdHJsLmpzIiwibGF5b3V0L2Zvb3RlckN0cmwuanMiLCJsYXlvdXQvbmF2Q3RybC5qcyIsImxheW91dC9zaWRlYmFyQ3RybC5qcyIsImNvbXBvbmVudHMvYWRtaW4vdXNlckxpc3RDdHJsLmpzIiwiY29tcG9uZW50cy9ob21lL2hvbWVDdHJsLmpzIiwiY29tcG9uZW50cy9wcm9maWxlL3Byb2ZpbGVDdHJsLmpzIiwiY29tcG9uZW50cy9yZWNpcGVzL3JlY2lwZURldGFpbHNDdHJsLmpzIiwiY29tcG9uZW50cy9yZWNpcGVzL3JlY2lwZXNDdHJsLmpzIiwiY29tcG9uZW50cy9zaWduVXAvc2lnblVwQ3RybC5qcyIsInNoYXJlZC9wcm92aWRlcnMvbG9nZ2VyLmpzIiwic2hhcmVkL3Byb3ZpZGVycy9ub3RpZmljYXRpb25Qcm92aWRlci5qcyIsInNoYXJlZC9wcm92aWRlcnMvdmFsaWRhdGlvbi5qcyIsInNoYXJlZC9yZXNvdXJjZXMvcmVjaXBlUmVzb3VyY2UuanMiLCJzaGFyZWQvcmVzb3VyY2VzL3VzZXJSZXNvdXJjZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9hdXRoU2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9pZGVudGl0eVNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsSUFBQSxNQUFBLFFBQUEsT0FBQSxPQUFBOztRQUVBO1FBQ0E7UUFDQTtRQUNBOzs7UUFHQTtRQUNBOzs7UUFHQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7UUFDQTs7O0FDdEJBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxhQUFBOzs7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxZQUFBOzs7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxlQUFBOzs7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxlQUFBOzs7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxjQUFBOzs7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxpQkFBQTs7O0FDSEEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLGlCQUFBOzs7QUNIQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsZ0JBQUE7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLElBQUEs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LFNBQUEsU0FBQTtZQUNBLEdBQUEsa0JBQUE7OztZQUdBLEdBQUEsYUFBQSxLQUFBLElBQUEsQ0FBQSxHQUFBLGFBQUEsS0FBQSxHQUFBLFVBQUE7WUFDQSxHQUFBLFdBQUEsS0FBQSxJQUFBLEdBQUEsYUFBQSxHQUFBLFVBQUEsR0FBQSxnQkFBQTtZQUNBLEdBQUEsZUFBQSxHQUFBLGdCQUFBLE1BQUEsR0FBQSxZQUFBLEdBQUE7OztRQUdBLFNBQUEsc0JBQUEsYUFBQTtZQUNBLElBQUEsa0JBQUEsRUFBQSxPQUFBLGFBQUEsVUFBQSxZQUFBO2dCQUNBLE9BQUEsV0FBQTs7O1lBR0EsSUFBQSxRQUFBLEVBQUEsSUFBQSxpQkFBQSxVQUFBLFlBQUE7Z0JBQ0EsSUFBQSxDQUFBLE1BQUEsV0FBQSxXQUFBO29CQUNBLE9BQUEsV0FBQSxLQUFBLFNBQUE7OztnQkFHQSxPQUFBLFdBQUEsS0FBQTs7O1lBR0EsSUFBQSxZQUFBLE1BQUEsS0FBQTtZQUNBLElBQUEsVUFBQSxTQUFBLEdBQUE7Z0JBQ0EsWUFBQSxVQUFBLEdBQUEsZ0JBQUEsVUFBQSxNQUFBO2dCQUNBLGFBQUE7OztZQUdBLE9BQUE7Ozs7QUN0RkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLGNBQUEsV0FBQSxjQUFBOztJQUVBLFdBQUEsVUFBQSxDQUFBLFVBQUEsVUFBQSxVQUFBLHdCQUFBLGNBQUE7O0lBRUEsU0FBQSxXQUFBLFFBQUEsUUFBQSxRQUFBLHNCQUFBLFlBQUEsYUFBQTtRQUNBLElBQUEsS0FBQTs7Ozs7UUFLQSxHQUFBLFdBQUEsV0FBQTtRQUNBLEdBQUEsU0FBQTs7Ozs7UUFLQTs7UUFFQSxTQUFBLE9BQUE7WUFDQSxPQUFBLE1BQUEsWUFBQSxNQUFBOzs7Ozs7UUFNQSxTQUFBLFNBQUE7WUFDQSxPQUFBLE1BQUEsWUFBQSxRQUFBO1lBQ0EsR0FBQSxZQUFBOztZQUVBLElBQUEsY0FBQTtnQkFDQSxVQUFBLEdBQUE7Z0JBQ0EsVUFBQSxHQUFBO2dCQUNBLFdBQUEsR0FBQTtnQkFDQSxVQUFBLEdBQUE7OztZQUdBLFlBQUEsV0FBQTtpQkFDQSxLQUFBLFlBQUE7b0JBQ0EscUJBQUEsUUFBQTtvQkFDQSxPQUFBLEdBQUE7O2lCQUVBLE1BQUEsVUFBQSxlQUFBO29CQUNBLHFCQUFBLE1BQUE7O2lCQUVBLFFBQUEsWUFBQTtvQkFDQSxHQUFBLFlBQUE7Ozs7O0FDaERBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxpQkFBQSxRQUFBLFVBQUE7O0lBRUEsT0FBQSxVQUFBLENBQUE7O0lBRUEsU0FBQSxPQUFBLE1BQUE7Ozs7UUFJQSxTQUFBLE1BQUEsTUFBQSxNQUFBLEtBQUE7WUFDQSxLQUFBLE1BQUEsU0FBQSxNQUFBLE1BQUE7OztRQUdBLFNBQUEsTUFBQSxNQUFBLE1BQUEsS0FBQTtZQUNBLEtBQUEsTUFBQSxTQUFBLE1BQUEsTUFBQTs7O1FBR0EsU0FBQSxLQUFBLE1BQUEsTUFBQSxLQUFBO1lBQ0EsS0FBQSxLQUFBLFNBQUEsTUFBQSxNQUFBOzs7UUFHQSxTQUFBLElBQUEsTUFBQSxNQUFBLEtBQUE7WUFDQSxLQUFBLElBQUEsU0FBQSxNQUFBLE1BQUE7OztRQUdBLFNBQUEsS0FBQSxNQUFBLE1BQUEsS0FBQTtZQUNBLEtBQUEsS0FBQSxTQUFBLE1BQUEsTUFBQTs7Ozs7O1FBTUEsU0FBQSxTQUFBLE1BQUEsTUFBQSxLQUFBO1lBQ0EsT0FBQSxLQUFBLE9BQUEsU0FBQSxLQUFBLE9BQUEsU0FBQTs7Ozs7O1FBTUEsT0FBQTtZQUNBLE9BQUE7WUFDQSxPQUFBO1lBQ0EsTUFBQTtZQUNBLEtBQUE7WUFDQSxNQUFBOzs7Ozs7QUM3Q0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLGlCQUFBLE1BQUEsVUFBQTtJQUNBLFFBQUEsT0FBQSxpQkFBQSxRQUFBLHdCQUFBOztJQUVBLHFCQUFBLFVBQUEsQ0FBQSxVQUFBOztJQUVBLFNBQUEscUJBQUEsUUFBQSxRQUFBOzs7O1FBSUEsT0FBQSxVQUFBO1lBQ0EsYUFBQTtZQUNBLE9BQUE7WUFDQSxhQUFBO1lBQ0EsYUFBQTtZQUNBLGVBQUE7WUFDQSxtQkFBQTtZQUNBLFNBQUE7WUFDQSxjQUFBO1lBQ0EsY0FBQTtZQUNBLFNBQUE7WUFDQSxpQkFBQTtZQUNBLFlBQUE7WUFDQSxZQUFBO1lBQ0EsWUFBQTtZQUNBLFlBQUE7Ozs7OztRQU1BLFNBQUEsUUFBQSxLQUFBO1lBQ0EsT0FBQSxRQUFBO1lBQ0EsT0FBQSxNQUFBLHNCQUFBLFNBQUE7OztRQUdBLFNBQUEsS0FBQSxLQUFBO1lBQ0EsT0FBQSxLQUFBO1lBQ0EsT0FBQSxNQUFBLHNCQUFBLE1BQUE7OztRQUdBLFNBQUEsUUFBQSxLQUFBO1lBQ0EsT0FBQSxRQUFBO1lBQ0EsT0FBQSxNQUFBLHNCQUFBLFNBQUE7OztRQUdBLFNBQUEsTUFBQSxLQUFBO1lBQ0EsT0FBQSxNQUFBO1lBQ0EsT0FBQSxNQUFBLHNCQUFBLE9BQUE7Ozs7OztRQU1BLE9BQUE7WUFDQSxTQUFBO1lBQ0EsTUFBQTtZQUNBLFNBQUE7WUFDQSxPQUFBOzs7OztBQzdEQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsaUJBQUEsUUFBQSxjQUFBOztJQUVBLFdBQUEsVUFBQTs7SUFFQSxTQUFBLGFBQUE7Ozs7UUFJQSxTQUFBLFNBQUEsTUFBQSxhQUFBO1lBQ0EsT0FBQSxLQUFBLGNBQUEsWUFBQTs7O1FBR0EsU0FBQSxRQUFBLE1BQUEsYUFBQTtZQUNBLE9BQUEsQ0FBQSxLQUFBLGNBQUEsWUFBQSxVQUFBLFlBQUE7OztRQUdBLFNBQUEsV0FBQSxhQUFBO1lBQ0EsT0FBQSxZQUFBLFVBQUEsQ0FBQSxZQUFBOzs7UUFHQSxTQUFBLFNBQUEsTUFBQSxhQUFBO1lBQ0EsT0FBQTtnQkFDQSxhQUFBLFNBQUEsTUFBQTtnQkFDQSxlQUFBLFFBQUEsTUFBQTtnQkFDQSxlQUFBLFdBQUE7Ozs7Ozs7UUFPQSxPQUFBO1lBQ0EsVUFBQTtZQUNBLFNBQUE7WUFDQSxZQUFBO1lBQ0EsVUFBQTs7Ozs7QUN0Q0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLGlCQUFBLFFBQUEsa0JBQUE7O0lBRUEsZUFBQSxVQUFBLENBQUE7O0lB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QUFBLFFBQUE7Ozs7OztRQU1BLFNBQUEsa0JBQUE7WUFDQSxPQUFBLENBQUEsQ0FBQSxLQUFBOzs7UUFHQSxTQUFBLGFBQUEsTUFBQTtZQUNBLE9BQUEsQ0FBQSxDQUFBLEtBQUEsZUFBQSxLQUFBLFlBQUEsTUFBQSxRQUFBLFNBQUE7Ozs7OztRQU1BLE9BQUE7WUFDQSxhQUFBO1lBQ0EsaUJBQUE7WUFDQSxjQUFBOzs7O0tBSUEiLCJmaWxlIjoicHVibGljL2FwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAvLyBQcmVkZWZpbmVkIG1vZHVsZXMuXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxuICAgICAgICAndWkucm91dGVyJyxcbiAgICAgICAgJ25nUmVzb3VyY2UnLFxuICAgICAgICAnbmdSb3V0ZScsXG5cbiAgICAgICAgLy8gQXBwIGNvbXBvbmVudHMuXG4gICAgICAgICdhcHAuaG9tZScsXG4gICAgICAgICdhcHAucmVjaXBlcycsXG5cbiAgICAgICAgLy8gQWRtaW4gY29tcG9uZW50cy5cbiAgICAgICAgJ2FwcC5hZG1pbicsXG4gICAgICAgICdhcHAucHJvZmlsZScsXG4gICAgICAgICdhcHAuc2lnblVwJyxcblxuICAgICAgICAvLyBBcHAgc2hhcmVkLlxuICAgICAgICAnYXBwLnByb3ZpZGVycycsXG4gICAgICAgICdhcHAuc2VydmljZXMnLFxuICAgICAgICAnYXBwLnJlc291cmNlcydcbiAgICBdKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmFkbWluJywgW1xuXG4gICAgXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWUnLCBbXG5cbiAgICBdKTtcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucHJvZmlsZScsIFtcblxuICAgIF0pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5yZWNpcGVzJywgW1xuXG4gICAgXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNpZ25VcCcsIFtcblxuICAgIF0pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5wcm92aWRlcnMnLCBbXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnJlc291cmNlcycsIFtdKTtcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuc2VydmljZXMnLCBbXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xuXG4gICAgYXBwLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJGxvZ1Byb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbigkbG9nUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgIC8vIExvZ2dpbmcuXG4gICAgICAgICRsb2dQcm92aWRlci5kZWJ1Z0VuYWJsZWQodHJ1ZSk7XG5cbiAgICAgICAgLy8gSFRNTDUgbW9kZS5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICByZXF1aXJlQmFzZTogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWx3YXlzIGRlZmF1bHQgdG8gaG9tZSBwYWdlLlxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvYXBwL2hvbWUnKTtcblxuICAgICAgICAvLyBSb3V0ZXMuXG4gICAgICAgIHZhciBkZWZhdWx0Q3RybEFzID0gJ3ZtJztcbiAgICAgICAgdmFyIG1haW5WaWV3c09iaiA9IHtcbiAgICAgICAgICAgIG5hdjoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2xheW91dC9uYXZUbXBsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTmF2Q3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBkZWZhdWx0Q3RybEFzXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJyc6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9sYXlvdXQvY29udGVudFRtcGwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdDb250ZW50Q3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBkZWZhdWx0Q3RybEFzXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2lkZWJhcjoge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2xheW91dC9zaWRlYmFyVG1wbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZGViYXJDdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IGRlZmF1bHRDdHJsQXNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmb290ZXI6IHtcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9sYXlvdXQvZm9vdGVyVG1wbCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Zvb3RlckN0cmwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogZGVmYXVsdEN0cmxBc1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB1cmw6ICcvYXBwJyxcbiAgICAgICAgICAgICAgICB2aWV3czogbWFpblZpZXdzT2JqXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgZXh0cmEgcHJvcGVydGllcyB0byBlYWNoIHN0YXRlLlxuICAgIGFwcC5ydW4oWyckcm9vdFNjb3BlJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbiAoZXZlbnQsIGN1cnJlbnQpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUudGl0bGUgPSBjdXJyZW50LnRpdGxlO1xuICAgICAgICAgICAgJHJvb3RTY29wZS5ib2R5Q3NzID0gY3VycmVudC5ib2R5Q3NzO1xuICAgICAgICB9KTtcbiAgICB9XSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgYXBwQWRtaW4gPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmFkbWluJyk7XG5cbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAvLyBDb25maWcuXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgYXBwQWRtaW4uY29uZmlnKENvbmZpZ3VyYXRpb24pO1xuXG4gICAgQ29uZmlndXJhdGlvbi4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAgICAgICB2YXIgcm91dGVSb2xlQ2hlY2tzID0ge1xuICAgICAgICAgICAgYWRtaW46IHtcbiAgICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUN1cnJlbnRVc2VyRm9yUm91dGUoJ2FkbWluJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC51c2VyTGlzdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvdXNlci1saXN0JyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9jb21wb25lbnRzL2FkbWluL3VzZXJMaXN0VmlldycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1VzZXJMaXN0Q3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHJvdXRlUm9sZUNoZWNrcy5hZG1pbixcbiAgICAgICAgICAgICAgICB0aXRsZTogJ1VzZXIgTGlzdCcsXG4gICAgICAgICAgICAgICAgYm9keUNzczogJ3VzZXItbGlzdCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIC8vIFJ1bi5cbiAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICBhcHBBZG1pbi5ydW4oUnVuKTtcblxuICAgIFJ1bi4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyRzdGF0ZSddO1xuXG4gICAgZnVuY3Rpb24gUnVuKCRyb290U2NvcGUsICRzdGF0ZSkge1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbiAoZXZlbnQsIHRvU3RhdGUsIHRvUGFyYW1zLCBmcm9tU3RhdGUsIGZyb21QYXJhbXMsIGVycm9yKSB7XG4gICAgICAgICAgICBpZiAoZXJyb3Iubm90QXV0aG9yaXplZCkge1xuICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLmhvbWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZScpLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIGZ1bmN0aW9uIENvbmZpZ3VyYXRpb24oJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLmhvbWUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2hvbWUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2NvbXBvbmVudHMvaG9tZS9ob21lVmlldycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0hvbWVDdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdIb21lJyxcbiAgICAgICAgICAgICAgICBib2R5Q3NzOiAnaG9tZSdcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucHJvZmlsZScpLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIGZ1bmN0aW9uIENvbmZpZ3VyYXRpb24oJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgdmFyIHJvdXRlUm9sZUNoZWNrcyA9IHtcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICBhdXRoOiBmdW5jdGlvbiAoYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF1dGhTZXJ2aWNlLmF1dGhvcml6ZUF1dGhlbnRpY2F0ZWRVc2VyRm9yUm91dGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLnByb2ZpbGUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3Byb2ZpbGUnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2NvbXBvbmVudHMvcHJvZmlsZS9wcm9maWxlVmlldycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Byb2ZpbGVDdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICAgICAgcmVzb2x2ZTogcm91dGVSb2xlQ2hlY2tzLnVzZXIsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdQcm9maWxlJyxcbiAgICAgICAgICAgICAgICBib2R5Q3NzOiAncHJvZmlsZSdcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucmVjaXBlcycpLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInXTtcblxuICAgIGZ1bmN0aW9uIENvbmZpZ3VyYXRpb24oJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwLnJlY2lwZXMnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlY2lwZXMnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2NvbXBvbmVudHMvcmVjaXBlcy9yZWNpcGVzVmlldycsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1JlY2lwZXNDdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdSZWNpcGVzJyxcbiAgICAgICAgICAgICAgICBib2R5Q3NzOiAncmVjaXBlcydcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5yZWNpcGVEZXRhaWxzJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9yZWNpcGUvOmlkJyxcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9jb21wb25lbnRzL3JlY2lwZXMvcmVjaXBlRGV0YWlsc1ZpZXcnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWNpcGVEZXRhaWxzQ3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgICAgIHRpdGxlOiAnUmVjaXBlIERldGFpbHMnLFxuICAgICAgICAgICAgICAgIGJvZHlDc3M6ICdyZWNpcGUtZGV0YWlscydcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBhcHBTaWduVXAgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLnNpZ25VcCcpO1xuXG4gICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgLy8gQ29uZmlnLlxuICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgIGFwcFNpZ25VcC5jb25maWcoQ29uZmlndXJhdGlvbik7XG5cbiAgICBDb25maWd1cmF0aW9uLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJ107XG5cbiAgICBmdW5jdGlvbiBDb25maWd1cmF0aW9uKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXG4gICAgICAgICAgICAuc3RhdGUoJ2FwcC5zaWduVXAnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3NpZ24tdXAnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2NvbXBvbmVudHMvc2lnblVwL3NpZ25VcFZpZXcnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTaWduVXBDdHJsJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXG4gICAgICAgICAgICAgICAgdGl0bGU6ICdTaWduIFVwJyxcbiAgICAgICAgICAgICAgICBib2R5Q3NzOiAnc2lnbi11cCdcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucHJvdmlkZXJzJykuY29uZmlnKENvbmZpZ3VyYXRpb24pO1xuXG4gICAgQ29uZmlndXJhdGlvbi4kaW5qZWN0ID0gW107XG5cbiAgICBmdW5jdGlvbiBDb25maWd1cmF0aW9uKCkge1xuXG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5yZXNvdXJjZXMnKS5jb25maWcoQ29uZmlndXJhdGlvbik7XG5cbiAgICBDb25maWd1cmF0aW9uLiRpbmplY3QgPSBbXTtcblxuICAgIGZ1bmN0aW9uIENvbmZpZ3VyYXRpb24oKSB7XG5cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNlcnZpY2VzJykuY29uZmlnKENvbmZpZ3VyYXRpb24pO1xuXG4gICAgQ29uZmlndXJhdGlvbi4kaW5qZWN0ID0gW107XG5cbiAgICBmdW5jdGlvbiBDb25maWd1cmF0aW9uKCkge1xuXG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0NvbnRlbnRDdHJsJywgQ29udGVudEN0cmwpO1xuXG4gICAgQ29udGVudEN0cmwuJGluamVjdCA9IFsnbG9nZ2VyJ107XG5cbiAgICBmdW5jdGlvbiBDb250ZW50Q3RybChsb2dnZXIpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhDb250ZW50Q3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ0Zvb3RlckN0cmwnLCBGb290ZXJDdHJsKTtcblxuICAgIEZvb3RlckN0cmwuJGluamVjdCA9IFsnbG9nZ2VyJ107XG5cbiAgICBmdW5jdGlvbiBGb290ZXJDdHJsKGxvZ2dlcikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKEZvb3RlckN0cmwsIGluaXQsICdJbml0aWFsaXppbmcuLi4nKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdOYXZDdHJsJywgTmF2Q3RybCk7XG5cbiAgICBOYXZDdHJsLiRpbmplY3QgPSBbJ2xvZ2dlcicsICckaHR0cCcsICckc3RhdGUnLCAnbm90aWZpY2F0aW9uUHJvdmlkZXInLCAnaWRlbnRpdHlTZXJ2aWNlJywgJ2F1dGhTZXJ2aWNlJ107XG5cbiAgICBmdW5jdGlvbiBOYXZDdHJsKGxvZ2dlciwgJGh0dHAsICRzdGF0ZSwgbm90aWZpY2F0aW9uUHJvdmlkZXIsIGlkZW50aXR5U2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICB2bS5sb2dJbiA9IGxvZ0luO1xuICAgICAgICB2bS5sb2dPdXQgPSBsb2dPdXQ7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5hdkN0cmwsIGluaXQsICdJbml0aWFsaXppbmcuLi4nKTtcbiAgICAgICAgICAgIHZtLmlkZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMgaW1wbGVtZW50YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGxvZ0luKCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5hdkN0cmwsIGxvZ0luLCAnU2lnbmluZyBpbi4uLicpO1xuXG4gICAgICAgICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHZtLnVzZXJuYW1lLCB2bS5wYXNzd29yZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uUHJvdmlkZXIuc3VjY2VzcygnWW91IGhhdmUgc3VjY2Vzc2Z1bGx5IGxvZ2dlZCBpbi4nKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblByb3ZpZGVyLmVycm9yKCdJbnZhbGlkIHVzZXIgbmFtZSBvciBwYXNzd29yZCEnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9nT3V0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5hdkN0cmwsIGxvZ091dCwgJ1NpZ25pbmcgaW4uLi4nKTtcblxuICAgICAgICAgICAgYXV0aFNlcnZpY2UubG9nT3V0VXNlcigpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS51c2VybmFtZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICB2bS5wYXNzd29yZCA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25Qcm92aWRlci5pbmZvKCdZb3UgaGF2ZSBiZWVuIGxvZ2dlZCBvdXQuJyk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLmhvbWUnKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdTaWRlYmFyQ3RybCcsIFNpZGViYXJDdHJsKTtcblxuICAgIFNpZGViYXJDdHJsLiRpbmplY3QgPSBbJ2xvZ2dlciddO1xuXG4gICAgZnVuY3Rpb24gU2lkZWJhckN0cmwobG9nZ2VyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoU2lkZWJhckN0cmwsIGluaXQsICdJbml0aWFsaXppbmcuLi4nKTtcbiAgICAgICAgICAgIHZtLnRlc3QgPSAndGVzdCBzdHJpbmcnO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5hZG1pbicpLmNvbnRyb2xsZXIoJ1VzZXJMaXN0Q3RybCcsIFVzZXJMaXN0Q3RybCk7XG5cbiAgICBVc2VyTGlzdEN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ2xvZ2dlcicsICdVc2VyUmVzb3VyY2UnXTtcblxuICAgIGZ1bmN0aW9uIFVzZXJMaXN0Q3RybCgkc2NvcGUsIGxvZ2dlciwgVXNlclJlc291cmNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoVXNlckxpc3RDdHJsLCBpbml0LCAnSW5pdGlhbGl6aW5nLi4uJyk7XG4gICAgICAgICAgICB2bS51c2VycyA9IFVzZXJSZXNvdXJjZS5xdWVyeSgpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuaG9tZScpLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgSG9tZUN0cmwpO1xuXG4gICAgSG9tZUN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ2xvZ2dlciddO1xuXG4gICAgZnVuY3Rpb24gSG9tZUN0cmwoJHNjb3BlLCBsb2dnZXIpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhIb21lQ3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucHJvZmlsZScpLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDdHJsJywgUHJvZmlsZUN0cmwpO1xuXG4gICAgUHJvZmlsZUN0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ2xvZ2dlcicsICd2YWxpZGF0aW9uJywgJ2F1dGhTZXJ2aWNlJywgJ2lkZW50aXR5U2VydmljZScsICdub3RpZmljYXRpb25Qcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gUHJvZmlsZUN0cmwoJHNjb3BlLCBsb2dnZXIsIHZhbGlkYXRpb24sIGF1dGhTZXJ2aWNlLCBpZGVudGl0eVNlcnZpY2UsIG5vdGlmaWNhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHZtLmdldENsYXNzID0gdmFsaWRhdGlvbi5nZXRDbGFzcztcbiAgICAgICAgdm0udXBkYXRlID0gdXBkYXRlO1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhQcm9maWxlQ3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuXG4gICAgICAgICAgICAvLyBVcGRhdGUgdmlldy5cbiAgICAgICAgICAgIHZtLmVtYWlsID0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLnVzZXJuYW1lO1xuICAgICAgICAgICAgdm0uZmlyc3ROYW1lID0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmZpcnN0TmFtZTtcbiAgICAgICAgICAgIHZtLmxhc3ROYW1lID0gaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyLmxhc3ROYW1lO1xuICAgICAgICB9XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMgaW1wbGVtZW50YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhQcm9maWxlQ3RybCwgdXBkYXRlLCAnVXBkYXRpbmcgdXNlciBwcm9maWxlLi4uJyk7XG4gICAgICAgICAgICB2bS5pc0xvYWRpbmcgPSB0cnVlO1xuXG4gICAgICAgICAgICB2YXIgbmV3VXNlckRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHZtLmVtYWlsLFxuICAgICAgICAgICAgICAgIGZpcnN0TmFtZTogdm0uZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB2bS5sYXN0TmFtZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHZtLnBhc3N3b3JkICYmIHZtLnBhc3N3b3JkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBuZXdVc2VyRGF0YS5wYXNzd29yZCA9IHZtLnBhc3N3b3JkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBhdXRoU2VydmljZS51cGRhdGVDdXJyZW50VXNlcihuZXdVc2VyRGF0YSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblByb3ZpZGVyLnN1Y2Nlc3MoJ1lvdXIgdXNlciBwcm9maWxlIGhhcyBiZWVuIHVwZGF0ZWQuJyk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICAgICAgICAgICAgICBub3RpZmljYXRpb25Qcm92aWRlci5lcnJvcihyZWFzb24pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnJlY2lwZXMnKS5jb250cm9sbGVyKCdSZWNpcGVEZXRhaWxzQ3RybCcsIFJlY2lwZURldGFpbHNDdHJsKTtcblxuICAgIFJlY2lwZURldGFpbHNDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICdsb2dnZXInLCAnJHN0YXRlUGFyYW1zJywgJ1JlY2lwZVJlc291cmNlJ107XG5cbiAgICBmdW5jdGlvbiBSZWNpcGVEZXRhaWxzQ3RybCgkc2NvcGUsIGxvZ2dlciwgJHN0YXRlUGFyYW1zLCBSZWNpcGVSZXNvdXJjZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZWQgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICB2bS5nZXRJbmdyZWRpZW50RGlzcGxheSA9IGdldEluZ3JlZGllbnREaXNwbGF5O1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhSZWNpcGVEZXRhaWxzQ3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuXG4gICAgICAgICAgICBSZWNpcGVSZXNvdXJjZS5nZXQoeyBfaWQ6ICRzdGF0ZVBhcmFtcy5pZCB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnJlY2lwZSA9IGRhdGE7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZWQgZnVuY3Rpb25zIGltcGxlbWVudGF0aW9uLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBnZXRJbmdyZWRpZW50RGlzcGxheShpbmdyZWRpZW50KSB7XG4gICAgICAgICAgICB2YXIgcXVhbnRpdHlTdHIgPSBpbmdyZWRpZW50LnF1YW50aXR5LnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBuYW1lU3RyID0gaW5ncmVkaWVudC5uYW1lLnRyaW0oKTtcblxuICAgICAgICAgICAgaWYgKCFpc05hTihpbmdyZWRpZW50LnF1YW50aXR5KSkge1xuICAgICAgICAgICAgICAgIHF1YW50aXR5U3RyICs9ICcgeCAnO1xuICAgICAgICAgICAgICAgIGlmIChpbmdyZWRpZW50LnF1YW50aXR5ID4gMSkge1xuICAgICAgICAgICAgICAgICAgICBuYW1lU3RyICs9ICdzJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHF1YW50aXR5U3RyICs9ICcgb2YgJ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcXVhbnRpdHlTdHIgKyBuYW1lU3RyO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucmVjaXBlcycpLmNvbnRyb2xsZXIoJ1JlY2lwZXNDdHJsJywgUmVjaXBlc0N0cmwpO1xuXG4gICAgUmVjaXBlc0N0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJ2xvZ2dlcicsICdSZWNpcGVSZXNvdXJjZSddO1xuXG4gICAgZnVuY3Rpb24gUmVjaXBlc0N0cmwoJHNjb3BlLCBsb2dnZXIsIFJlY2lwZVJlc291cmNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gQ29uc3RhbnRzLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICB2bS5wYWdlTnVtYmVyID0gMTtcbiAgICAgICAgdm0ucGFnZVNpemUgPSAxMDtcbiAgICAgICAgdm0uZGVib3VuY2UgPSB7IGRlYm91bmNlOiAzMDAgfTtcblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2VkIGZ1bmN0aW9ucy5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgdm0uZ2V0RmlsdGVyZWQgPSBnZXRGaWx0ZXJlZDtcbiAgICAgICAgdm0udXBkYXRlID0gdXBkYXRlO1xuICAgICAgICB2bS5nZXRNYWluSW5ncmVkaWVudHNTdHIgPSBnZXRNYWluSW5ncmVkaWVudHNTdHI7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFJlY2lwZXNDdHJsLCBpbml0LCAnSW5pdGlhbGl6aW5nLi4uJyk7XG4gICAgICAgICAgICBSZWNpcGVSZXNvdXJjZS5xdWVyeShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLnJlY2lwZXMgPSBfLnNvcnRCeShkYXRhLCAnbmFtZScpO1xuICAgICAgICAgICAgICAgIHZtLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2VkIGZ1bmN0aW9ucyBpbXBsZW1lbnRhdGlvbi5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gZ2V0RmlsdGVyZWQoKSB7XG4gICAgICAgICAgICB2YXIgbG93ZXJDYXNlU2VhcmNoID0gdm0uc2VhcmNoID8gdm0uc2VhcmNoLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gXy5maWx0ZXIodm0ucmVjaXBlcywgZnVuY3Rpb24gKHJlY2lwZSkge1xuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hSZXN1bHQgPSAhdm0uc2VhcmNoXG4gICAgICAgICAgICAgICAgICAgIHx8IHJlY2lwZS5uYW1lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihsb3dlckNhc2VTZWFyY2gpID49IDBcbiAgICAgICAgICAgICAgICAgICAgfHwgXy5maWx0ZXIocmVjaXBlLmluZ3JlZGllbnRzLCBmdW5jdGlvbiAoaW5ncmVkaWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZ3JlZGllbnQubmFtZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YobG93ZXJDYXNlU2VhcmNoKSA+PSAwO1xuICAgICAgICAgICAgICAgICAgICB9KS5sZW5ndGggPiAwO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1heFRpbWVSZXN1bHQgPSAhdm0ubWF4VGltZSB8fCByZWNpcGUudGltZSA8PSB2bS5tYXhUaW1lO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlYXJjaFJlc3VsdCAmJiBtYXhUaW1lUmVzdWx0O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICAgICAgICB2bS5maWx0ZXJlZFJlY2lwZXMgPSBnZXRGaWx0ZXJlZCgpO1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgcGFnZS5cbiAgICAgICAgICAgIHZtLnN0YXJ0SW5kZXggPSBNYXRoLm1heCgodm0ucGFnZU51bWJlciAtIDEpICogdm0ucGFnZVNpemUsIDApO1xuICAgICAgICAgICAgdm0uZW5kSW5kZXggPSBNYXRoLm1pbih2bS5wYWdlTnVtYmVyICogdm0ucGFnZVNpemUsIHZtLmZpbHRlcmVkUmVjaXBlcy5sZW5ndGgpO1xuICAgICAgICAgICAgdm0ucGFnZWRSZWNpcGVzID0gdm0uZmlsdGVyZWRSZWNpcGVzLnNsaWNlKHZtLnN0YXJ0SW5kZXgsIHZtLmVuZEluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldE1haW5JbmdyZWRpZW50c1N0cihpbmdyZWRpZW50cykge1xuICAgICAgICAgICAgdmFyIG1haW5JbmdyZWRpZW50cyA9IF8uZmlsdGVyKGluZ3JlZGllbnRzLCBmdW5jdGlvbiAoaW5ncmVkaWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmdyZWRpZW50LmlzTWFpbjtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgbmFtZXMgPSBfLm1hcChtYWluSW5ncmVkaWVudHMsIGZ1bmN0aW9uIChpbmdyZWRpZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihpbmdyZWRpZW50LnF1YW50aXR5KSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5ncmVkaWVudC5uYW1lLnRyaW0oKSArICdzJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gaW5ncmVkaWVudC5uYW1lLnRyaW0oKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgam9pbmVkU3RyID0gbmFtZXMuam9pbignLCAnKTtcbiAgICAgICAgICAgIGlmIChqb2luZWRTdHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGpvaW5lZFN0ciA9IGpvaW5lZFN0clswXS50b1VwcGVyQ2FzZSgpICsgam9pbmVkU3RyLnNsaWNlKDEpO1xuICAgICAgICAgICAgICAgIGpvaW5lZFN0ciArPSAnLic7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBqb2luZWRTdHI7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5zaWduVXAnKS5jb250cm9sbGVyKCdTaWduVXBDdHJsJywgU2lnblVwQ3RybCk7XG5cbiAgICBTaWduVXBDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnbG9nZ2VyJywgJ25vdGlmaWNhdGlvblByb3ZpZGVyJywgJ3ZhbGlkYXRpb24nLCAnYXV0aFNlcnZpY2UnXTtcblxuICAgIGZ1bmN0aW9uIFNpZ25VcEN0cmwoJHNjb3BlLCAkc3RhdGUsIGxvZ2dlciwgbm90aWZpY2F0aW9uUHJvdmlkZXIsIHZhbGlkYXRpb24sIGF1dGhTZXJ2aWNlKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHZtLmdldENsYXNzID0gdmFsaWRhdGlvbi5nZXRDbGFzcztcbiAgICAgICAgdm0uc2lnblVwID0gc2lnblVwO1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEluaXRpYWxpemF0aW9uLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhTaWduVXBDdHJsLCBpbml0LCAnSW5pdGlhbGl6aW5nLi4uJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2VkIGZ1bmN0aW9ucyBpbXBsZW1lbnRhdGlvbi5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gc2lnblVwKCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKFNpZ25VcEN0cmwsIHNpZ25VcCwgJ1N1Ym1pdHRpbmcgZm9ybS4uLicpO1xuICAgICAgICAgICAgdm0uaXNMb2FkaW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgdmFyIG5ld1VzZXJEYXRhID0ge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB2bS5lbWFpbCxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogdm0ucGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB2bS5maXJzdE5hbWUsXG4gICAgICAgICAgICAgICAgbGFzdE5hbWU6IHZtLmxhc3ROYW1lXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBhdXRoU2VydmljZS5jcmVhdGVVc2VyKG5ld1VzZXJEYXRhKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uUHJvdmlkZXIuc3VjY2VzcygnVXNlciBzdWNjZXNzZnVsbHkgY3JlYXRlZC4nKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdhcHAuaG9tZScpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnJvclJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblByb3ZpZGVyLmVycm9yKGVycm9yUmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmZpbmFsbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycpLmZhY3RvcnkoJ2xvZ2dlcicsIExvZ2dlcik7XG5cbiAgICBMb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xuXG4gICAgZnVuY3Rpb24gTG9nZ2VyKCRsb2cpIHtcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGRlYnVnKGN0cmwsIGZ1bmMsIG1zZykge1xuICAgICAgICAgICAgJGxvZy5kZWJ1ZyhidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKGN0cmwsIGZ1bmMsIG1zZykge1xuICAgICAgICAgICAgJGxvZy5lcnJvcihidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8oY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLmluZm8oYnVpbGRNc2coY3RybCwgZnVuYywgbXNnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2coY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLmxvZyhidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm4oY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLndhcm4oYnVpbGRNc2coY3RybCwgZnVuYywgbXNnKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBIZWxwZXIgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpIHtcbiAgICAgICAgICAgIHJldHVybiBjdHJsLm5hbWUgKyAnIC0+ICcgKyBmdW5jLm5hbWUgKyAnKCk6ICcgKyBtc2c7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGVidWc6IGRlYnVnLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgaW5mbzogaW5mbyxcbiAgICAgICAgICAgIGxvZzogbG9nLFxuICAgICAgICAgICAgd2Fybjogd2FyblxuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiLCJcbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5wcm92aWRlcnMnKS52YWx1ZSgndG9hc3RyJywgdG9hc3RyKTtcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycpLmZhY3RvcnkoJ25vdGlmaWNhdGlvblByb3ZpZGVyJywgTm90aWZpY2F0aW9uUHJvdmlkZXIpO1xuXG4gICAgTm90aWZpY2F0aW9uUHJvdmlkZXIuJGluamVjdCA9IFsndG9hc3RyJywgJ2xvZ2dlciddO1xuXG4gICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uUHJvdmlkZXIodG9hc3RyLCBsb2dnZXIpIHtcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gVG9hc3RyIG9wdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLFxuICAgICAgICAgICAgZGVidWc6IGZhbHNlLFxuICAgICAgICAgICAgbmV3ZXN0T25Ub3A6IGZhbHNlLFxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXI6IGZhbHNlLFxuICAgICAgICAgICAgcG9zaXRpb25DbGFzczogJ3RvYXN0LXRvcC1jZW50ZXInLFxuICAgICAgICAgICAgcHJldmVudER1cGxpY2F0ZXM6IGZhbHNlLFxuICAgICAgICAgICAgb25jbGljazogbnVsbCxcbiAgICAgICAgICAgIHNob3dEdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgaGlkZUR1cmF0aW9uOiAxMDAwLFxuICAgICAgICAgICAgdGltZU91dDogMjAwMCxcbiAgICAgICAgICAgIGV4dGVuZGVkVGltZU91dDogMTAwMCxcbiAgICAgICAgICAgIHNob3dFYXNpbmc6ICdzd2luZycsXG4gICAgICAgICAgICBoaWRlRWFzaW5nOiAnbGluZWFyJyxcbiAgICAgICAgICAgIHNob3dNZXRob2Q6ICdmYWRlSW4nLFxuICAgICAgICAgICAgaGlkZU1ldGhvZDogJ2ZhZGVPdXQnXG4gICAgICAgIH07XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gUHVibGljIGZ1bmN0aW9ucy5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gc3VjY2Vzcyhtc2cpIHtcbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKG1zZyk7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoTm90aWZpY2F0aW9uUHJvdmlkZXIsIHN1Y2Nlc3MsIG1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbmZvKG1zZykge1xuICAgICAgICAgICAgdG9hc3RyLmluZm8obXNnKTtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhOb3RpZmljYXRpb25Qcm92aWRlciwgaW5mbywgbXNnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobXNnKSB7XG4gICAgICAgICAgICB0b2FzdHIud2FybmluZyhtc2cpO1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5vdGlmaWNhdGlvblByb3ZpZGVyLCB3YXJuaW5nLCBtc2cpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobXNnKTtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhOb3RpZmljYXRpb25Qcm92aWRlciwgZXJyb3IsIG1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgICAgICAgIGluZm86IGluZm8sXG4gICAgICAgICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yXG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5wcm92aWRlcnMnKS5mYWN0b3J5KCd2YWxpZGF0aW9uJywgVmFsaWRhdGlvbik7XG5cbiAgICBWYWxpZGF0aW9uLiRpbmplY3QgPSBbXTtcblxuICAgIGZ1bmN0aW9uIFZhbGlkYXRpb24oKSB7XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZWQgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBoYXNFcnJvcihmb3JtLCBmb3JtRWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIGZvcm0uJHN1Ym1pdHRlZCAmJiBmb3JtRWxlbWVudC4kaW52YWxpZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhc1dhcm4oZm9ybSwgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiAhZm9ybS4kc3VibWl0dGVkICYmIGZvcm1FbGVtZW50LiRkaXJ0eSAmJiBmb3JtRWxlbWVudC4kaW52YWxpZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhc1N1Y2Nlc3MoZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmb3JtRWxlbWVudC4kZGlydHkgJiYgIWZvcm1FbGVtZW50LiRpbnZhbGlkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0Q2xhc3MoZm9ybSwgZm9ybUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgJ2hhcy1lcnJvcic6IGhhc0Vycm9yKGZvcm0sIGZvcm1FbGVtZW50KSxcbiAgICAgICAgICAgICAgICAnaGFzLXdhcm5pbmcnOiBoYXNXYXJuKGZvcm0sIGZvcm1FbGVtZW50KSxcbiAgICAgICAgICAgICAgICAnaGFzLXN1Y2Nlc3MnOiBoYXNTdWNjZXNzKGZvcm1FbGVtZW50KVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZSBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBoYXNFcnJvcjogaGFzRXJyb3IsXG4gICAgICAgICAgICBoYXNXYXJuOiBoYXNXYXJuLFxuICAgICAgICAgICAgaGFzU3VjY2VzczogaGFzU3VjY2VzcyxcbiAgICAgICAgICAgIGdldENsYXNzOiBnZXRDbGFzc1xuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAucmVzb3VyY2VzJykuZmFjdG9yeSgnUmVjaXBlUmVzb3VyY2UnLCBSZWNpcGVSZXNvdXJjZSk7XG5cbiAgICBSZWNpcGVSZXNvdXJjZS4kaW5qZWN0ID0gWyckcmVzb3VyY2UnXTtcblxuICAgIGZ1bmN0aW9uIFJlY2lwZVJlc291cmNlKCRyZXNvdXJjZSkge1xuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBSZXNvdXJjZS5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgdmFyIFJlY2lwZVJlcyA9ICRyZXNvdXJjZSgnL2FwaS9yZWNpcGVzLzpfaWQnLCB7IF9pZDogJ0BpZCcgfSwge1xuICAgICAgICAgICAgdXBkYXRlOiB7IG1ldGhvZDogJ1BVVCcsIGlzQXJyYXk6IGZhbHNlIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgUmVjaXBlUmVzLnByb3RvdHlwZS50ZW1wID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIFJlY2lwZVJlcztcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnJlc291cmNlcycpLmZhY3RvcnkoJ1VzZXJSZXNvdXJjZScsIFVzZXJSZXNvdXJjZSk7XG5cbiAgICBVc2VyUmVzb3VyY2UuJGluamVjdCA9IFsnJHJlc291cmNlJ107XG5cbiAgICBmdW5jdGlvbiBVc2VyUmVzb3VyY2UoJHJlc291cmNlKSB7XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFJlc291cmNlLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICB2YXIgVXNlclJlcyA9ICRyZXNvdXJjZSgnL2FwaS91c2Vycy86aWQnLCB7X2lkOiAnQGlkJ30sIHtcbiAgICAgICAgICAgIHVwZGF0ZTogeyBtZXRob2Q6ICdQVVQnLCBpc0FycmF5OiBmYWxzZSB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIFVzZXJSZXMucHJvdG90eXBlLmlzQWRtaW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yb2xlcyAmJiB0aGlzLnJvbGVzLmluZGV4T2YoJ2FkbWluJykgPj0gMDtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gVXNlclJlcztcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnNlcnZpY2VzJykuZmFjdG9yeSgnYXV0aFNlcnZpY2UnLCBBdXRoU2VydmljZSk7XG5cbiAgICBBdXRoU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsICckcScsICdsb2dnZXInLCAnaWRlbnRpdHlTZXJ2aWNlJywgJ1VzZXJSZXNvdXJjZSddO1xuXG4gICAgZnVuY3Rpb24gQXV0aFNlcnZpY2UoJGh0dHAsICRxLCBsb2dnZXIsIGlkZW50aXR5U2VydmljZSwgVXNlclJlc291cmNlKSB7XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFZhcmlhYmxlcy5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgdmFyIG5vdEF1dGhvcml6ZWRPYmogPSB7IG5vdEF1dGhvcml6ZWQ6IHRydWUgfTtcblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBQdWJsaWMgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgJGh0dHAucG9zdCgnL2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlciA9IG5ldyBVc2VyUmVzb3VyY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodXNlciwgcmVzcG9uc2UuZGF0YS51c2VyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGN1cnJlbnQgdXNlci5cbiAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gdXNlcjtcblxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ091dFVzZXIoKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvbG9nb3V0JywgeyBsb2dPdXQ6IHRydWUgfSlcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkZW50aXR5U2VydmljZS5jdXJyZW50VXNlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVVc2VyKG5ld1VzZXJEYXRhKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgdmFyIG5ld1VzZXIgPSBuZXcgVXNlclJlc291cmNlKG5ld1VzZXJEYXRhKTtcblxuICAgICAgICAgICAgbmV3VXNlci4kc2F2ZSgpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSBuZXdVc2VyO1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yUmVzcG9uc2UuZGF0YS5yZWFzb24pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyKG5ld1VzZXJEYXRhKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICB2YXIgY2xvbmUgPSBhbmd1bGFyLmNvcHkoaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKGNsb25lLCBuZXdVc2VyRGF0YSk7XG5cbiAgICAgICAgICAgIGNsb25lLiR1cGRhdGUoKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWRlbnRpdHlTZXJ2aWNlLmN1cnJlbnRVc2VyID0gY2xvbmU7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyb3JSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3JSZXNwb25zZS5kYXRhLnJlYXNvbik7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYXV0aG9yaXplQ3VycmVudFVzZXJGb3JSb3V0ZShyb2xlKSB7XG4gICAgICAgICAgICBpZiAoaWRlbnRpdHlTZXJ2aWNlLmlzQXV0aG9yaXplZChyb2xlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KG5vdEF1dGhvcml6ZWRPYmopO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZSgpIHtcbiAgICAgICAgICAgIGlmIChpZGVudGl0eVNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChub3RBdXRob3JpemVkT2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZSBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBhdXRoZW50aWNhdGVVc2VyOiBhdXRoZW50aWNhdGVVc2VyLFxuICAgICAgICAgICAgbG9nT3V0VXNlcjogbG9nT3V0VXNlcixcbiAgICAgICAgICAgIGNyZWF0ZVVzZXI6IGNyZWF0ZVVzZXIsXG4gICAgICAgICAgICB1cGRhdGVDdXJyZW50VXNlcjogdXBkYXRlQ3VycmVudFVzZXIsXG4gICAgICAgICAgICBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlOiBhdXRob3JpemVDdXJyZW50VXNlckZvclJvdXRlLFxuICAgICAgICAgICAgYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZTogYXV0aG9yaXplQXV0aGVudGljYXRlZFVzZXJGb3JSb3V0ZVxuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuc2VydmljZXMnKS5mYWN0b3J5KCdpZGVudGl0eVNlcnZpY2UnLCBJZGVudGl0eVNlcnZpY2UpO1xuXG4gICAgSWRlbnRpdHlTZXJ2aWNlLiRpbmplY3QgPSBbJyR3aW5kb3cnLCAnbG9nZ2VyJywgJ1VzZXJSZXNvdXJjZSddO1xuXG4gICAgZnVuY3Rpb24gSWRlbnRpdHlTZXJ2aWNlKCR3aW5kb3csIGxvZ2dlciwgVXNlclJlc291cmNlKSB7XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEhhbmRsZSBib290c3RyYXBwZWQgY3VycmVudCB1c2VyIG9iamVjdC5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgdmFyIGN1cnJlbnRVc2VyID0gbnVsbDtcblxuICAgICAgICBpZiAoISEkd2luZG93LmJvb3RzdHJhcHBlZFVzZXJPYmplY3QpIHtcbiAgICAgICAgICAgIGN1cnJlbnRVc2VyID0gbmV3IFVzZXJSZXNvdXJjZSgpO1xuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoY3VycmVudFVzZXIsICR3aW5kb3cuYm9vdHN0cmFwcGVkVXNlck9iamVjdCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBQdWJsaWMgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gISF0aGlzLmN1cnJlbnRVc2VyO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaXNBdXRob3JpemVkKHJvbGUpIHtcbiAgICAgICAgICAgIHJldHVybiAhIXRoaXMuY3VycmVudFVzZXIgJiYgdGhpcy5jdXJyZW50VXNlci5yb2xlcy5pbmRleE9mKHJvbGUpID49IDA7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY3VycmVudFVzZXI6IGN1cnJlbnRVc2VyLFxuICAgICAgICAgICAgaXNBdXRoZW50aWNhdGVkOiBpc0F1dGhlbnRpY2F0ZWQsXG4gICAgICAgICAgICBpc0F1dGhvcml6ZWQ6IGlzQXV0aG9yaXplZFxuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=