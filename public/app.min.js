(function () {
    'use strict';

    var app = angular.module('app', [
        // Predefined modules.
        'ui.bootstrap',
        'ui.router',
        'ngResource',
        'ngRoute',

        // App components.
        'app.home',

        // App shared.
        'app.providers',
        'app.services'
    ]);
})();
(function () {
    'use strict';

    angular.module('app.home', [

    ]);

})();
(function () {
    'use strict';

    angular.module('app.providers', []);

})();
(function () {
    'use strict';

    angular.module('app.services', []);

})();
(function () {
    'use strict';

    var app = angular.module('app');

    app.config(Configuration);

    Configuration.$inject = ['$logProvider', '$stateProvider', '$urlRouterProvider', '$locationProvider'];

    function Configuration($logProvider, $stateProvider, $urlRouterProvider, $locationProvider) {
        // Logging.
        $logProvider.debugEnabled(true);

        // HTML5 mode.
        $locationProvider.html5Mode({
            enabled: true,
            requireBase: false
        });

        // Always default to home page.
        $urlRouterProvider.otherwise('/app/home');

        // Routes.
        var defaultCtrlAs = 'vm';
        $stateProvider
            .state('app', {
                abstract: true,
                url: '/app',
                views: {
                    nav: {
                        templateUrl: '/partials/layout/navTmpl',
                        controller: 'NavCtrl',
                        controllerAs: defaultCtrlAs
                    },
                    '': {
                        templateUrl: '/partials/layout/contentTmpl',
                        controller: 'ContentCtrl',
                        controllerAs: defaultCtrlAs
                    },
                    sidebar: {
                        templateUrl: '/partials/layout/sidebarTmpl',
                        controller: 'SidebarCtrl',
                        controllerAs: defaultCtrlAs
                    },
                    footer: {
                        templateUrl: '/partials/layout/footerTmpl',
                        controller: 'FooterCtrl',
                        controllerAs: defaultCtrlAs
                    }
                }
            });
    }

    // Add extra properties to each state.
    app.run(['$rootScope', function ($rootScope) {
        $rootScope.$on('$stateChangeSuccess', function (event, current) {
            $rootScope.title = current.title;
            $rootScope.bodyCss = current.bodyCss;
        });
    }]);

})();
(function () {
    'use strict';

    angular.module('app.home').config(Configuration);

    Configuration.$inject = ['$stateProvider'];

    function Configuration($stateProvider) {
        $stateProvider
            .state('app.home', {
                url: '/home',
                templateUrl: '/partials/components/home/homeView',
                controller: 'HomeCtrl',
                controllerAs: 'vm',
                title: 'Home',
                bodyCss: "home"
            });
    }

})();
(function () {
    'use strict';

    angular.module('app.providers').config(Configuration);

    Configuration.$inject = [];

    function Configuration() {

    }

})();
(function () {
    'use strict';

    angular.module('app.services').config(Configuration);

    Configuration.$inject = [];

    function Configuration() {

    }

})();
(function () {
    'use strict';

    angular.module('app').controller('ContentCtrl', ContentCtrl);

    ContentCtrl.$inject = ['logger'];

    function ContentCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(ContentCtrl, init, 'Initializing...');
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('FooterCtrl', FooterCtrl);

    FooterCtrl.$inject = ['logger'];

    function FooterCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(FooterCtrl, init, 'Initializing...');
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('NavCtrl', NavCtrl);

    NavCtrl.$inject = ['logger', '$http', 'notificationProvider', 'identityService', 'authService'];

    function NavCtrl(logger, $http, notificationProvider, identityService, authService) {
        var vm = this;

        //=====================================================================
        // Expose functions.
        //=====================================================================
        vm.logIn = logIn;

        //=====================================================================
        // Initialization.
        //=====================================================================
        init();

        function init() {
            logger.debug(NavCtrl, init, 'Initializing...');
            vm.identity = identityService;
        }

        //=====================================================================
        // Exposed functions implementation.
        //=====================================================================
        function logIn() {
            logger.debug(NavCtrl, logIn, 'Signing in...');

            authService.authenticateUser(vm.username, vm.password)
                .then(function (success) {
                    if (success) {
                        notificationProvider.success('You have successfully logged in!');
                    } else {
                        notificationProvider.error('Invalid user name or password!');
                    }
                });
        }

    }
})();
(function () {
    'use strict';

    angular.module('app').controller('SidebarCtrl', SidebarCtrl);

    SidebarCtrl.$inject = ['logger'];

    function SidebarCtrl(logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(SidebarCtrl, init, 'Initializing...');
            vm.test = 'Test Recipe';
        }

    }
})();
(function () {
    'use strict';

    angular.module('app.home').controller('HomeCtrl', HomeCtrl);

    HomeCtrl.$inject = ['$scope', 'logger'];

    function HomeCtrl($scope, logger) {
        var vm = this;

        init();

        function init() {
            logger.debug(HomeCtrl, init, 'Initializing...');
        }
    }
})();
(function () {
    'use strict';

    angular.module('app.providers').factory('logger', Logger);

    Logger.$inject = ['$log'];

    function Logger($log) {
        //=====================================================================
        // Exposed functions.
        //=====================================================================
        function debug(ctrl, func, msg) {
            $log.debug(buildMsg(ctrl, func, msg));
        }

        function error(ctrl, func, msg) {
            $log.error(buildMsg(ctrl, func, msg));
        }

        function info(ctrl, func, msg) {
            $log.info(buildMsg(ctrl, func, msg));
        }

        function log(ctrl, func, msg) {
            $log.log(buildMsg(ctrl, func, msg));
        }

        function warn(ctrl, func, msg) {
            $log.warn(buildMsg(ctrl, func, msg));
        }

        //=====================================================================
        // Helper functions.
        //=====================================================================
        function buildMsg(ctrl, func, msg) {
            return ctrl.name + ' -> ' + func.name + '(): ' + msg;
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            debug: debug,
            error: error,
            info: info,
            log: log,
            warn: warn
        };
    }

})();

(function () {
    'use strict';

    angular.module('app.providers').value('toastr', toastr);
    angular.module('app.providers').factory('notificationProvider', NotificationProvider);

    NotificationProvider.$inject = ['toastr', 'logger'];

    function NotificationProvider(toastr, logger) {
        //=====================================================================
        // Toastr options.
        //=====================================================================
        toastr.options = {
            closeButton: false,
            debug: false,
            newestOnTop: false,
            progressBar: false,
            positionClass: 'toast-top-center',
            preventDuplicates: false,
            onclick: null,
            showDuration: 500,
            hideDuration: 1000,
            timeOut: 2000,
            extendedTimeOut: 1000,
            showEasing: 'swing',
            hideEasing: 'linear',
            showMethod: 'fadeIn',
            hideMethod: 'fadeOut'
        };

        //=====================================================================
        // Public functions.
        //=====================================================================
        function success(msg) {
            toastr.success(msg);
            logger.debug(NotificationProvider, success, msg);
        }

        function info(msg) {
            toastr.info(msg);
            logger.debug(NotificationProvider, info, msg);
        }

        function warning(msg) {
            toastr.warning(msg);
            logger.debug(NotificationProvider, warning, msg);
        }

        function error(msg) {
            toastr.error(msg);
            logger.debug(NotificationProvider, error, msg);
        }

        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            success: success,
            info: info,
            warning: warning,
            error: error
        };
    }

})();
(function () {
    'use strict';

    angular.module('app.services').factory('authService', AuthService);

    AuthService.$inject = ['$http', '$q', 'logger', 'identityService'];

    function AuthService($http, $q, logger, identityService) {
        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            authenticateUser: authenticateUser
        };

        //=====================================================================
        // Public functions.
        //=====================================================================
        function authenticateUser(username, password) {
            var deferred = $q.defer();

            $http.post('/login', {
                username: username,
                password: password
            }).then(function (response) {
                // Save current user.
                identityService.currentUser = response.data.user;

                if (response.data.success) {
                    deferred.resolve(true);
                } else {
                    deferred.resolve(false);
                }
            });

            return deferred.promise;
        }
    }

})();
(function () {
    'use strict';

    angular.module('app.services').factory('identityService', IdentityService);

    IdentityService.$inject = ['logger'];

    function IdentityService(logger) {
        //=====================================================================
        // Expose functions.
        //=====================================================================
        return {
            currentUser: null,
            isAuthenticated: isAuthenticated
        };

        //=====================================================================
        // Public functions.
        //=====================================================================
        function isAuthenticated() {
            return !!this.currentUser;
        }
    }

})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjb21wb25lbnRzL2hvbWUvYXBwLmhvbWUubW9kdWxlLmpzIiwic2hhcmVkL3Byb3ZpZGVycy9hcHAucHJvdmlkZXJzLm1vZHVsZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9hcHAuc2VydmljZXMubW9kdWxlLmpzIiwiYXBwLmNvbmZpZy5qcyIsImNvbXBvbmVudHMvaG9tZS9hcHAuaG9tZS5jb25maWcuanMiLCJzaGFyZWQvcHJvdmlkZXJzL2FwcC5wcm92aWRlcnMuY29uZmlnLmpzIiwic2hhcmVkL3NlcnZpY2VzL2FwcC5zZXJ2aWNlcy5jb25maWcuanMiLCJsYXlvdXQvY29udGVudEN0cmwuanMiLCJsYXlvdXQvZm9vdGVyQ3RybC5qcyIsImxheW91dC9uYXZDdHJsLmpzIiwibGF5b3V0L3NpZGViYXJDdHJsLmpzIiwiY29tcG9uZW50cy9ob21lL2hvbWVDdHJsLmpzIiwic2hhcmVkL3Byb3ZpZGVycy9sb2dnZXIuanMiLCJzaGFyZWQvcHJvdmlkZXJzL25vdGlmaWNhdGlvblByb3ZpZGVyLmpzIiwic2hhcmVkL3NlcnZpY2VzL2F1dGhTZXJ2aWNlLmpzIiwic2hhcmVkL3NlcnZpY2VzL2lkZW50aXR5U2VydmljZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxJQUFBLE1BQUEsUUFBQSxPQUFBLE9BQUE7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7OztRQUdBOzs7UUFHQTtRQUNBOzs7QUNmQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsWUFBQTs7Ozs7QUNIQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsaUJBQUE7OztBQ0hBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxnQkFBQTs7O0FDSEEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsSUFBQSxNQUFBLFFBQUEsT0FBQTs7SUFFQSxJQUFBLE9BQUE7O0lBRUEsY0FBQSxVQUFBLENBQUEsZ0JBQUEs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QUFBLFVBQUE7O0lBRUEsU0FBQSxTQUFBLFFBQUEsUUFBQTtRQUNBLElBQUEsS0FBQTs7UUFFQTs7UUFFQSxTQUFBLE9BQUE7WUFDQSxPQUFBLE1BQUEsVUFBQSxNQUFBOzs7O0FDYkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUEsUUFBQSxPQUFBLGlCQUFBLFFBQUEsVUFBQTs7SUFFQSxPQUFBLFVBQUEsQ0FBQTs7SUFFQSxTQUFBLE9BQUEsTUFBQTs7OztRQUlBLFNBQUEsTUFBQSxNQUFBLE1BQUEsS0FBQTtZQUNBLEtBQUEsTUFBQSxTQUFBLE1BQUEsTUFBQTs7O1FBR0EsU0FBQSxNQUFBLE1BQUEsTUFBQSxLQUFBO1lBQ0EsS0FBQSxNQUFBLFNBQUEsTUFBQSxNQUFBOzs7UUFHQSxTQUFBLEtBQUEsTUFBQSxNQUFBLEtBQUE7WUFDQSxLQUFBLEtBQUEsU0FBQSxNQUFBLE1BQUE7OztRQUdBLFNBQUEsSUFBQSxNQUFBLE1BQUEsS0FBQTtZQUNBLEtBQUEsSUFBQSxTQUFBLE1BQUEsTUFBQTs7O1FBR0EsU0FBQSxLQUFBLE1BQUEsTUFBQSxLQUFBO1lBQ0EsS0FBQSxLQUFBLFNBQUEsTUFBQSxNQUFBOzs7Ozs7UUFNQSxTQUFBLFNBQUEsTUFBQSxNQUFBLEtBQUE7WUFDQSxPQUFBLEtBQUEsT0FBQSxTQUFBLEtBQUEsT0FBQSxTQUFBOzs7Ozs7UUFNQSxPQUFBO1lBQ0EsT0FBQTtZQUNBLE9BQUE7WUFDQSxNQUFBO1lBQ0EsS0FBQTtZQUNBLE1BQUE7Ozs7OztBQzdDQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsaUJBQUEsTUFBQSxVQUFBO0lBQ0EsUUFBQSxPQUFBLGlCQUFBLFFBQUEsd0JBQUE7O0lBRUEscUJBQUEsVUFBQSxDQUFBLFVBQUE7O0lBRUEsU0FBQSxxQkFBQSxRQUFBLFFBQUE7Ozs7UUFJQSxPQUFBLFVBQUE7WUFDQSxhQUFBO1lBQ0EsT0FBQTtZQUNBLGFBQUE7WUFDQSxhQUFBO1lBQ0EsZUFBQTtZQUNBLG1CQUFBO1lBQ0EsU0FBQTtZQUNBLGNBQUE7WUFDQSxjQUFBO1lBQ0EsU0FBQTtZQUNBLGlCQUFBO1lBQ0EsWUFBQTtZQUNBLFlBQUE7WUFDQSxZQUFBO1lBQ0EsWUFBQTs7Ozs7O1FBTUEsU0FBQSxRQUFBLEtBQUE7WUFDQSxPQUFBLFFBQUE7WUFDQSxPQUFBLE1BQUEsc0JBQUEsU0FBQTs7O1FBR0EsU0FBQSxLQUFBLEtBQUE7WUFDQSxPQUFBLEtBQUE7WUFDQSxPQUFBLE1BQUEsc0JBQUEsTUFBQTs7O1FBR0EsU0FBQSxRQUFBLEtBQUE7WUFDQSxPQUFBLFFBQUE7WUFDQSxPQUFBLE1BQUEsc0JBQUEsU0FBQTs7O1FBR0EsU0FBQSxNQUFBLEtBQUE7WUFDQSxPQUFBLE1BQUE7WUFDQSxPQUFBLE1BQUEsc0JBQUEsT0FBQTs7Ozs7O1FBTUEsT0FBQTtZQUNBLFNBQUE7WUFDQSxNQUFBO1lBQ0EsU0FBQTtZQUNBLE9BQUE7Ozs7O0FDN0RBLENBQUEsWUFBQTtJQUNBOztJQUVBLFFBQUEsT0FBQSxnQkFBQSxRQUFBLGVBQUE7O0lBRUEsWUFBQSxVQUFBLENBQUEsU0FBQSxNQUFBLFVBQUE7O0lBRUEsU0FBQSxZQUFBLE9BQUEsSUFBQSxRQUFBLGlCQUFBOzs7O1FBSUEsT0FBQTtZQUNBLGtCQUFBOzs7Ozs7UUFNQSxTQUFBLGlCQUFBLFVBQUEsVUFBQTtZQUNBLElBQUEsV0FBQSxHQUFBOztZQUVBLE1BQUEsS0FBQSxVQUFBO2dCQUNBLFVBQUE7Z0JBQ0EsVUFBQTtlQUNBLEtBQUEsVUFBQSxVQUFBOztnQkFFQSxnQkFBQSxjQUFBLFNBQUEsS0FBQTs7Z0JBRUEsSUFBQSxTQUFBLEtBQUEsU0FBQTtvQkFDQSxTQUFBLFFBQUE7dUJBQ0E7b0JBQ0EsU0FBQSxRQUFBOzs7O1lBSUEsT0FBQSxTQUFBOzs7OztBQ25DQSxDQUFBLFlBQUE7SUFDQTs7SUFFQSxRQUFBLE9BQUEsZ0JBQUEsUUFBQSxtQkFBQTs7SUFFQSxnQkFBQSxVQUFBLENBQUE7O0lBRUEsU0FBQSxnQkFBQSxRQUFBOzs7O1FBSUEsT0FBQTtZQUNBLGFBQUE7WUFDQSxpQkFBQTs7Ozs7O1FBTUEsU0FBQSxrQkFBQTtZQUNBLE9BQUEsQ0FBQSxDQUFBLEtBQUE7Ozs7S0FJQSIsImZpbGUiOiJwdWJsaWMvYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG4gICAgICAgIC8vIFByZWRlZmluZWQgbW9kdWxlcy5cbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAnbmdSZXNvdXJjZScsXG4gICAgICAgICduZ1JvdXRlJyxcblxuICAgICAgICAvLyBBcHAgY29tcG9uZW50cy5cbiAgICAgICAgJ2FwcC5ob21lJyxcblxuICAgICAgICAvLyBBcHAgc2hhcmVkLlxuICAgICAgICAnYXBwLnByb3ZpZGVycycsXG4gICAgICAgICdhcHAuc2VydmljZXMnXG4gICAgXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lJywgW1xuXG4gICAgXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycsIFtdKTtcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuc2VydmljZXMnLCBbXSk7XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xuXG4gICAgYXBwLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFsnJGxvZ1Byb3ZpZGVyJywgJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlcicsICckbG9jYXRpb25Qcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbigkbG9nUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgIC8vIExvZ2dpbmcuXG4gICAgICAgICRsb2dQcm92aWRlci5kZWJ1Z0VuYWJsZWQodHJ1ZSk7XG5cbiAgICAgICAgLy8gSFRNTDUgbW9kZS5cbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICByZXF1aXJlQmFzZTogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWx3YXlzIGRlZmF1bHQgdG8gaG9tZSBwYWdlLlxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvYXBwL2hvbWUnKTtcblxuICAgICAgICAvLyBSb3V0ZXMuXG4gICAgICAgIHZhciBkZWZhdWx0Q3RybEFzID0gJ3ZtJztcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnYXBwJywge1xuICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHVybDogJy9hcHAnLFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hdjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvbGF5b3V0L25hdlRtcGwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05hdkN0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiBkZWZhdWx0Q3RybEFzXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICcnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9sYXlvdXQvY29udGVudFRtcGwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0NvbnRlbnRDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogZGVmYXVsdEN0cmxBc1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzaWRlYmFyOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9wYXJ0aWFscy9sYXlvdXQvc2lkZWJhclRtcGwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1NpZGViYXJDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogZGVmYXVsdEN0cmxBc1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmb290ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3BhcnRpYWxzL2xheW91dC9mb290ZXJUbXBsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdGb290ZXJDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogZGVmYXVsdEN0cmxBc1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQWRkIGV4dHJhIHByb3BlcnRpZXMgdG8gZWFjaCBzdGF0ZS5cbiAgICBhcHAucnVuKFsnJHJvb3RTY29wZScsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24gKGV2ZW50LCBjdXJyZW50KSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLnRpdGxlID0gY3VycmVudC50aXRsZTtcbiAgICAgICAgICAgICRyb290U2NvcGUuYm9keUNzcyA9IGN1cnJlbnQuYm9keUNzcztcbiAgICAgICAgfSk7XG4gICAgfV0pO1xuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5ob21lJykuY29uZmlnKENvbmZpZ3VyYXRpb24pO1xuXG4gICAgQ29uZmlndXJhdGlvbi4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbigkc3RhdGVQcm92aWRlcikge1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdhcHAuaG9tZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaG9tZScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvcGFydGlhbHMvY29tcG9uZW50cy9ob21lL2hvbWVWaWV3JyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnSG9tZUN0cmwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgICAgICB0aXRsZTogJ0hvbWUnLFxuICAgICAgICAgICAgICAgIGJvZHlDc3M6IFwiaG9tZVwiXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycpLmNvbmZpZyhDb25maWd1cmF0aW9uKTtcblxuICAgIENvbmZpZ3VyYXRpb24uJGluamVjdCA9IFtdO1xuXG4gICAgZnVuY3Rpb24gQ29uZmlndXJhdGlvbigpIHtcblxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuc2VydmljZXMnKS5jb25maWcoQ29uZmlndXJhdGlvbik7XG5cbiAgICBDb25maWd1cmF0aW9uLiRpbmplY3QgPSBbXTtcblxuICAgIGZ1bmN0aW9uIENvbmZpZ3VyYXRpb24oKSB7XG5cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ29udGVudEN0cmwnLCBDb250ZW50Q3RybCk7XG5cbiAgICBDb250ZW50Q3RybC4kaW5qZWN0ID0gWydsb2dnZXInXTtcblxuICAgIGZ1bmN0aW9uIENvbnRlbnRDdHJsKGxvZ2dlcikge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKENvbnRlbnRDdHJsLCBpbml0LCAnSW5pdGlhbGl6aW5nLi4uJyk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignRm9vdGVyQ3RybCcsIEZvb3RlckN0cmwpO1xuXG4gICAgRm9vdGVyQ3RybC4kaW5qZWN0ID0gWydsb2dnZXInXTtcblxuICAgIGZ1bmN0aW9uIEZvb3RlckN0cmwobG9nZ2VyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoRm9vdGVyQ3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ05hdkN0cmwnLCBOYXZDdHJsKTtcblxuICAgIE5hdkN0cmwuJGluamVjdCA9IFsnbG9nZ2VyJywgJyRodHRwJywgJ25vdGlmaWNhdGlvblByb3ZpZGVyJywgJ2lkZW50aXR5U2VydmljZScsICdhdXRoU2VydmljZSddO1xuXG4gICAgZnVuY3Rpb24gTmF2Q3RybChsb2dnZXIsICRodHRwLCBub3RpZmljYXRpb25Qcm92aWRlciwgaWRlbnRpdHlTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZSBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHZtLmxvZ0luID0gbG9nSW47XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gSW5pdGlhbGl6YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5hdkN0cmwsIGluaXQsICdJbml0aWFsaXppbmcuLi4nKTtcbiAgICAgICAgICAgIHZtLmlkZW50aXR5ID0gaWRlbnRpdHlTZXJ2aWNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMgaW1wbGVtZW50YXRpb24uXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGxvZ0luKCkge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5hdkN0cmwsIGxvZ0luLCAnU2lnbmluZyBpbi4uLicpO1xuXG4gICAgICAgICAgICBhdXRoU2VydmljZS5hdXRoZW50aWNhdGVVc2VyKHZtLnVzZXJuYW1lLCB2bS5wYXNzd29yZClcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZpY2F0aW9uUHJvdmlkZXIuc3VjY2VzcygnWW91IGhhdmUgc3VjY2Vzc2Z1bGx5IGxvZ2dlZCBpbiEnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvblByb3ZpZGVyLmVycm9yKCdJbnZhbGlkIHVzZXIgbmFtZSBvciBwYXNzd29yZCEnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ1NpZGViYXJDdHJsJywgU2lkZWJhckN0cmwpO1xuXG4gICAgU2lkZWJhckN0cmwuJGluamVjdCA9IFsnbG9nZ2VyJ107XG5cbiAgICBmdW5jdGlvbiBTaWRlYmFyQ3RybChsb2dnZXIpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICBpbml0KCk7XG5cbiAgICAgICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhTaWRlYmFyQ3RybCwgaW5pdCwgJ0luaXRpYWxpemluZy4uLicpO1xuICAgICAgICAgICAgdm0udGVzdCA9ICdUZXN0IFJlY2lwZSc7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmhvbWUnKS5jb250cm9sbGVyKCdIb21lQ3RybCcsIEhvbWVDdHJsKTtcblxuICAgIEhvbWVDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICdsb2dnZXInXTtcblxuICAgIGZ1bmN0aW9uIEhvbWVDdHJsKCRzY29wZSwgbG9nZ2VyKSB7XG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgaW5pdCgpO1xuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoSG9tZUN0cmwsIGluaXQsICdJbml0aWFsaXppbmcuLi4nKTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycpLmZhY3RvcnkoJ2xvZ2dlcicsIExvZ2dlcik7XG5cbiAgICBMb2dnZXIuJGluamVjdCA9IFsnJGxvZyddO1xuXG4gICAgZnVuY3Rpb24gTG9nZ2VyKCRsb2cpIHtcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gRXhwb3NlZCBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGRlYnVnKGN0cmwsIGZ1bmMsIG1zZykge1xuICAgICAgICAgICAgJGxvZy5kZWJ1ZyhidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKGN0cmwsIGZ1bmMsIG1zZykge1xuICAgICAgICAgICAgJGxvZy5lcnJvcihidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluZm8oY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLmluZm8oYnVpbGRNc2coY3RybCwgZnVuYywgbXNnKSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2coY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLmxvZyhidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm4oY3RybCwgZnVuYywgbXNnKSB7XG4gICAgICAgICAgICAkbG9nLndhcm4oYnVpbGRNc2coY3RybCwgZnVuYywgbXNnKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBIZWxwZXIgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICBmdW5jdGlvbiBidWlsZE1zZyhjdHJsLCBmdW5jLCBtc2cpIHtcbiAgICAgICAgICAgIHJldHVybiBjdHJsLm5hbWUgKyAnIC0+ICcgKyBmdW5jLm5hbWUgKyAnKCk6ICcgKyBtc2c7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZGVidWc6IGRlYnVnLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgaW5mbzogaW5mbyxcbiAgICAgICAgICAgIGxvZzogbG9nLFxuICAgICAgICAgICAgd2Fybjogd2FyblxuICAgICAgICB9O1xuICAgIH1cblxufSkoKTsiLCJcbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5wcm92aWRlcnMnKS52YWx1ZSgndG9hc3RyJywgdG9hc3RyKTtcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLnByb3ZpZGVycycpLmZhY3RvcnkoJ25vdGlmaWNhdGlvblByb3ZpZGVyJywgTm90aWZpY2F0aW9uUHJvdmlkZXIpO1xuXG4gICAgTm90aWZpY2F0aW9uUHJvdmlkZXIuJGluamVjdCA9IFsndG9hc3RyJywgJ2xvZ2dlciddO1xuXG4gICAgZnVuY3Rpb24gTm90aWZpY2F0aW9uUHJvdmlkZXIodG9hc3RyLCBsb2dnZXIpIHtcbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gVG9hc3RyIG9wdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLFxuICAgICAgICAgICAgZGVidWc6IGZhbHNlLFxuICAgICAgICAgICAgbmV3ZXN0T25Ub3A6IGZhbHNlLFxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXI6IGZhbHNlLFxuICAgICAgICAgICAgcG9zaXRpb25DbGFzczogJ3RvYXN0LXRvcC1jZW50ZXInLFxuICAgICAgICAgICAgcHJldmVudER1cGxpY2F0ZXM6IGZhbHNlLFxuICAgICAgICAgICAgb25jbGljazogbnVsbCxcbiAgICAgICAgICAgIHNob3dEdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgaGlkZUR1cmF0aW9uOiAxMDAwLFxuICAgICAgICAgICAgdGltZU91dDogMjAwMCxcbiAgICAgICAgICAgIGV4dGVuZGVkVGltZU91dDogMTAwMCxcbiAgICAgICAgICAgIHNob3dFYXNpbmc6ICdzd2luZycsXG4gICAgICAgICAgICBoaWRlRWFzaW5nOiAnbGluZWFyJyxcbiAgICAgICAgICAgIHNob3dNZXRob2Q6ICdmYWRlSW4nLFxuICAgICAgICAgICAgaGlkZU1ldGhvZDogJ2ZhZGVPdXQnXG4gICAgICAgIH07XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gUHVibGljIGZ1bmN0aW9ucy5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gc3VjY2Vzcyhtc2cpIHtcbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKG1zZyk7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoTm90aWZpY2F0aW9uUHJvdmlkZXIsIHN1Y2Nlc3MsIG1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBpbmZvKG1zZykge1xuICAgICAgICAgICAgdG9hc3RyLmluZm8obXNnKTtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhOb3RpZmljYXRpb25Qcm92aWRlciwgaW5mbywgbXNnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHdhcm5pbmcobXNnKSB7XG4gICAgICAgICAgICB0b2FzdHIud2FybmluZyhtc2cpO1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKE5vdGlmaWNhdGlvblByb3ZpZGVyLCB3YXJuaW5nLCBtc2cpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobXNnKTtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhOb3RpZmljYXRpb25Qcm92aWRlciwgZXJyb3IsIG1zZyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2Vzczogc3VjY2VzcyxcbiAgICAgICAgICAgIGluZm86IGluZm8sXG4gICAgICAgICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yXG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycpLmZhY3RvcnkoJ2F1dGhTZXJ2aWNlJywgQXV0aFNlcnZpY2UpO1xuXG4gICAgQXV0aFNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCAnJHEnLCAnbG9nZ2VyJywgJ2lkZW50aXR5U2VydmljZSddO1xuXG4gICAgZnVuY3Rpb24gQXV0aFNlcnZpY2UoJGh0dHAsICRxLCBsb2dnZXIsIGlkZW50aXR5U2VydmljZSkge1xuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICAvLyBFeHBvc2UgZnVuY3Rpb25zLlxuICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXV0aGVudGljYXRlVXNlcjogYXV0aGVudGljYXRlVXNlclxuICAgICAgICB9O1xuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIFB1YmxpYyBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBTYXZlIGN1cnJlbnQgdXNlci5cbiAgICAgICAgICAgICAgICBpZGVudGl0eVNlcnZpY2UuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhLnVzZXI7XG5cbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycpLmZhY3RvcnkoJ2lkZW50aXR5U2VydmljZScsIElkZW50aXR5U2VydmljZSk7XG5cbiAgICBJZGVudGl0eVNlcnZpY2UuJGluamVjdCA9IFsnbG9nZ2VyJ107XG5cbiAgICBmdW5jdGlvbiBJZGVudGl0eVNlcnZpY2UobG9nZ2VyKSB7XG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIC8vIEV4cG9zZSBmdW5jdGlvbnMuXG4gICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjdXJyZW50VXNlcjogbnVsbCxcbiAgICAgICAgICAgIGlzQXV0aGVudGljYXRlZDogaXNBdXRoZW50aWNhdGVkXG4gICAgICAgIH07XG5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgLy8gUHVibGljIGZ1bmN0aW9ucy5cbiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAgICAgICAgZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKCkge1xuICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5jdXJyZW50VXNlcjtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=